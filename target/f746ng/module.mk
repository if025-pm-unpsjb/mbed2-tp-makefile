###############################################################################
#
# Other object files required.
#
OBJECTS += ./libs/mbed/funcs.o
SYS_OBJECTS += $(wildcard ./target/f746ng/TARGET_DISCO_F746NG/TOOLCHAIN_GCC_ARM/*.o)

###############################################################################
#
# Paths to the required headers.
#
INCLUDE_PATHS += -I./libs/mbed
INCLUDE_PATHS += -I./libs/mbed/drivers
INCLUDE_PATHS += -I./libs/mbed/hal
INCLUDE_PATHS += -I./libs/mbed/platform
INCLUDE_PATHS += -I./target/f746ng/TARGET_DISCO_F746NG/TOOLCHAIN_GCC_ARM

###############################################################################
#
# Paths to the required libraries.
#
LIBRARY_PATHS += -L./target/f746ng/TARGET_DISCO_F746NG/TOOLCHAIN_GCC_ARM
LIBRARIES = -lmbed

###############################################################################
#
# Linker script used to build the binary.
#
LINKER_SCRIPT = ./target/f746ng/TARGET_DISCO_F746NG/TOOLCHAIN_GCC_ARM/STM32F746xG.ld

###############################################################################
#
# Floating point
#
ifeq ($(HARDFP),1)
	FLOAT_ABI = hard
else
	FLOAT_ABI = softfp
endif

###############################################################################
#
# CPU info.
#
CPU = -mcpu=cortex-m7 \
	-mthumb \
	-mfpu=fpv5-sp-d16 \
	-mfloat-abi=$(FLOAT_ABI)

###############################################################################
#
# Common flags and symbols used by the compiler for all the examples.
#
#COMMON_FLAGS += $(CPU) \
	-c \
	-g \
	-Wall \
	-fno-common \
	-fmessage-length=0 \
	-fno-exceptions \
	-fno-builtin \
	-ffunction-sections \
	-fdata-sections \
	-funsigned-char \
	-fno-delete-null-pointer-checks \
	-fomit-frame-pointer \
	-MMD \
	-MP

C_COMMON_FLAGS += -c
C_COMMON_FLAGS += -std=gnu11
C_COMMON_FLAGS += -include
C_COMMON_FLAGS += mbed_config.h
C_COMMON_FLAGS += -DTOOLCHAIN_GCC_ARM
C_COMMON_FLAGS += -D__MBED_CMSIS_RTOS_CM
C_COMMON_FLAGS += -DDEVICE_INTERRUPTIN=1
C_COMMON_FLAGS += -DHSE_VALUE=25000000
C_COMMON_FLAGS += -DTARGET_STM
C_COMMON_FLAGS += -D__FPU_PRESENT=1
C_COMMON_FLAGS += -DTARGET_STM32F746xG
C_COMMON_FLAGS += -DDEVICE_TRNG=1
C_COMMON_FLAGS += -DDEVICE_ANALOGIN=1
C_COMMON_FLAGS += -DARM_MATH_CM7
C_COMMON_FLAGS += -DDEVICE_PORTOUT=1
C_COMMON_FLAGS += -DDEVICE_SERIAL_FC=1
C_COMMON_FLAGS += -DDEVICE_SLEEP=1
C_COMMON_FLAGS += -DDEVICE_FLASH=1
C_COMMON_FLAGS += -DTOOLCHAIN_GCC
C_COMMON_FLAGS += -DTARGET_LIKE_CORTEX_M7
C_COMMON_FLAGS += -DDEVICE_EMAC=1
C_COMMON_FLAGS += -DDEVICE_USTICKER=1
C_COMMON_FLAGS += -DDEVICE_WATCHDOG=1
C_COMMON_FLAGS += -DDEVICE_I2CSLAVE=1
C_COMMON_FLAGS += -DTARGET_STM32F7
C_COMMON_FLAGS += -DDEVICE_SPI=1
C_COMMON_FLAGS += -DTARGET_N25Q128A
C_COMMON_FLAGS += -DDEVICE_CAN=1
C_COMMON_FLAGS += -DTARGET_DISCO_F746NG
C_COMMON_FLAGS += -D__MBED__=1
C_COMMON_FLAGS += -DMBED_TICKLESS
C_COMMON_FLAGS += -DDEVICE_I2C_ASYNCH=1
C_COMMON_FLAGS += -DDEVICE_MPU=1
C_COMMON_FLAGS += -DCOMPONENT_FLASHIAP=1
C_COMMON_FLAGS += -DDEVICE_SPI_ASYNCH=1
C_COMMON_FLAGS += -DDEVICE_QSPI=1
C_COMMON_FLAGS += -DDEVICE_I2C=1
C_COMMON_FLAGS += -DDEVICE_SERIAL_ASYNCH=1
C_COMMON_FLAGS += -DTRANSACTION_QUEUE_SIZE_SPI=2
C_COMMON_FLAGS += -DTARGET_M7
C_COMMON_FLAGS += -DUSE_HAL_DRIVER
C_COMMON_FLAGS += -DDEVICE_ANALOGOUT=1
C_COMMON_FLAGS += -DTARGET_MCU_STM32
C_COMMON_FLAGS += -DSTM32F746xx
C_COMMON_FLAGS += -DCOMPONENT_QSPIF=1
C_COMMON_FLAGS += -DTARGET_RELEASE
C_COMMON_FLAGS += -DTARGET_LIKE_MBED
C_COMMON_FLAGS += -DTARGET_FF_ARDUINO
C_COMMON_FLAGS += -DDEVICE_LPTICKER=1
C_COMMON_FLAGS += -DDEVICE_USBDEVICE=1
C_COMMON_FLAGS += -D__CMSIS_RTOS
C_COMMON_FLAGS += -DDEVICE_SPISLAVE=1
C_COMMON_FLAGS += -DUSE_FULL_LL_DRIVER
C_COMMON_FLAGS += -DTARGET_CORTEX
C_COMMON_FLAGS += -DDEVICE_RTC=1
C_COMMON_FLAGS += -DTARGET_CORTEX_M
C_COMMON_FLAGS += -DDEVICE_PORTINOUT=1
C_COMMON_FLAGS += -DDEVICE_CRC=1
C_COMMON_FLAGS += -D__CORTEX_M7
C_COMMON_FLAGS += -DDEVICE_SERIAL=1
C_COMMON_FLAGS += -DTARGET_RTOS_M4_M7
C_COMMON_FLAGS += -DDEVICE_PORTIN=1
C_COMMON_FLAGS += -DMBED_BUILD_TIMESTAMP=1666807451.6677415
C_COMMON_FLAGS += -DDEVICE_PWMOUT=1
C_COMMON_FLAGS += -DDEVICE_STDIO_MESSAGES=1
C_COMMON_FLAGS += -DEXTRA_IDLE_STACK_REQUIRED
C_COMMON_FLAGS += -DTARGET_NAME=DISCO_F746NG
C_COMMON_FLAGS += -DDEVICE_RESET_REASON=1
C_COMMON_FLAGS += -include
C_COMMON_FLAGS += mbed_config.h
C_COMMON_FLAGS += -c
C_COMMON_FLAGS += -std=gnu11
C_COMMON_FLAGS += -Wall
C_COMMON_FLAGS += -Wextra
C_COMMON_FLAGS += -Wno-unused-parameter
C_COMMON_FLAGS += -Wno-missing-field-initializers
C_COMMON_FLAGS += -fmessage-length=0
C_COMMON_FLAGS += -fno-exceptions
C_COMMON_FLAGS += -ffunction-sections
C_COMMON_FLAGS += -fdata-sections
C_COMMON_FLAGS += -funsigned-char
C_COMMON_FLAGS += -MMD
C_COMMON_FLAGS += -fomit-frame-pointer
C_COMMON_FLAGS += -Os
C_COMMON_FLAGS += -g
C_COMMON_FLAGS += -DMBED_TRAP_ERRORS_ENABLED=1
C_COMMON_FLAGS += -DMBED_MINIMAL_PRINTF
C_COMMON_FLAGS += -mcpu=cortex-m7
C_COMMON_FLAGS += -mthumb
C_COMMON_FLAGS += -mfpu=fpv5-sp-d16
C_COMMON_FLAGS += -mfloat-abi=softfp
C_COMMON_FLAGS += -DMBED_ROM_START=0x8000000
C_COMMON_FLAGS += -DMBED_ROM_SIZE=0x100000
C_COMMON_FLAGS += -DMBED_ROM1_START=0x200000
C_COMMON_FLAGS += -DMBED_ROM1_SIZE=0x100000
C_COMMON_FLAGS += -DMBED_RAM_START=0x20010000
C_COMMON_FLAGS += -DMBED_RAM_SIZE=0x40000
C_COMMON_FLAGS += -DMBED_RAM1_START=0x20000000
C_COMMON_FLAGS += -DMBED_RAM1_SIZE=0x10000

#C_COMMON_FLAGS += -std=gnu99

CPP_COMMON_FLAGS += -c
CPP_COMMON_FLAGS += -std=gnu++14
CPP_COMMON_FLAGS += -fno-rtti
CPP_COMMON_FLAGS += -Wvla
CPP_COMMON_FLAGS += -include
CPP_COMMON_FLAGS += mbed_config.h
CPP_COMMON_FLAGS += -DTOOLCHAIN_GCC_ARM
CPP_COMMON_FLAGS += -D__MBED_CMSIS_RTOS_CM
CPP_COMMON_FLAGS += -DDEVICE_INTERRUPTIN=1
CPP_COMMON_FLAGS += -DHSE_VALUE=25000000
CPP_COMMON_FLAGS += -DTARGET_STM
CPP_COMMON_FLAGS += -D__FPU_PRESENT=1
CPP_COMMON_FLAGS += -DTARGET_STM32F746xG
CPP_COMMON_FLAGS += -DDEVICE_TRNG=1
CPP_COMMON_FLAGS += -DDEVICE_ANALOGIN=1
CPP_COMMON_FLAGS += -DARM_MATH_CM7
CPP_COMMON_FLAGS += -DDEVICE_PORTOUT=1
CPP_COMMON_FLAGS += -DDEVICE_SERIAL_FC=1
CPP_COMMON_FLAGS += -DDEVICE_SLEEP=1
CPP_COMMON_FLAGS += -DDEVICE_FLASH=1
CPP_COMMON_FLAGS += -DTOOLCHAIN_GCC
CPP_COMMON_FLAGS += -DTARGET_LIKE_CORTEX_M7
CPP_COMMON_FLAGS += -DDEVICE_EMAC=1
CPP_COMMON_FLAGS += -DDEVICE_USTICKER=1
CPP_COMMON_FLAGS += -DDEVICE_WATCHDOG=1
CPP_COMMON_FLAGS += -DDEVICE_I2CSLAVE=1
CPP_COMMON_FLAGS += -DTARGET_STM32F7
CPP_COMMON_FLAGS += -DDEVICE_SPI=1
CPP_COMMON_FLAGS += -DTARGET_N25Q128A
CPP_COMMON_FLAGS += -DDEVICE_CAN=1
CPP_COMMON_FLAGS += -DTARGET_DISCO_F746NG
CPP_COMMON_FLAGS += -D__MBED__=1
CPP_COMMON_FLAGS += -DMBED_TICKLESS
CPP_COMMON_FLAGS += -DDEVICE_I2C_ASYNCH=1
CPP_COMMON_FLAGS += -DDEVICE_MPU=1
CPP_COMMON_FLAGS += -DCOMPONENT_FLASHIAP=1
CPP_COMMON_FLAGS += -DDEVICE_SPI_ASYNCH=1
CPP_COMMON_FLAGS += -DDEVICE_QSPI=1
CPP_COMMON_FLAGS += -DDEVICE_I2C=1
CPP_COMMON_FLAGS += -DDEVICE_SERIAL_ASYNCH=1
CPP_COMMON_FLAGS += -DTRANSACTION_QUEUE_SIZE_SPI=2
CPP_COMMON_FLAGS += -DTARGET_M7
CPP_COMMON_FLAGS += -DUSE_HAL_DRIVER
CPP_COMMON_FLAGS += -DDEVICE_ANALOGOUT=1
CPP_COMMON_FLAGS += -DTARGET_MCU_STM32
CPP_COMMON_FLAGS += -DSTM32F746xx
CPP_COMMON_FLAGS += -DCOMPONENT_QSPIF=1
CPP_COMMON_FLAGS += -DTARGET_RELEASE
CPP_COMMON_FLAGS += -DTARGET_LIKE_MBED
CPP_COMMON_FLAGS += -DTARGET_FF_ARDUINO
CPP_COMMON_FLAGS += -DDEVICE_LPTICKER=1
CPP_COMMON_FLAGS += -DDEVICE_USBDEVICE=1
CPP_COMMON_FLAGS += -D__CMSIS_RTOS
CPP_COMMON_FLAGS += -DDEVICE_SPISLAVE=1
CPP_COMMON_FLAGS += -DUSE_FULL_LL_DRIVER
CPP_COMMON_FLAGS += -DTARGET_CORTEX
CPP_COMMON_FLAGS += -DDEVICE_RTC=1
CPP_COMMON_FLAGS += -DTARGET_CORTEX_M
CPP_COMMON_FLAGS += -DDEVICE_PORTINOUT=1
CPP_COMMON_FLAGS += -DDEVICE_CRC=1
CPP_COMMON_FLAGS += -D__CORTEX_M7
CPP_COMMON_FLAGS += -DDEVICE_SERIAL=1
CPP_COMMON_FLAGS += -DTARGET_RTOS_M4_M7
CPP_COMMON_FLAGS += -DDEVICE_PORTIN=1
CPP_COMMON_FLAGS += -DMBED_BUILD_TIMESTAMP=1666807451.6677415
CPP_COMMON_FLAGS += -DDEVICE_PWMOUT=1
CPP_COMMON_FLAGS += -DDEVICE_STDIO_MESSAGES=1
CPP_COMMON_FLAGS += -DEXTRA_IDLE_STACK_REQUIRED
CPP_COMMON_FLAGS += -DTARGET_NAME=DISCO_F746NG
CPP_COMMON_FLAGS += -DDEVICE_RESET_REASON=1
CPP_COMMON_FLAGS += -include
CPP_COMMON_FLAGS += mbed_config.h
CPP_COMMON_FLAGS += -c
CPP_COMMON_FLAGS += -std=gnu++14
CPP_COMMON_FLAGS += -fno-rtti
CPP_COMMON_FLAGS += -Wvla
CPP_COMMON_FLAGS += -Wall
CPP_COMMON_FLAGS += -Wextra
CPP_COMMON_FLAGS += -Wno-unused-parameter
CPP_COMMON_FLAGS += -Wno-missing-field-initializers
CPP_COMMON_FLAGS += -fmessage-length=0
CPP_COMMON_FLAGS += -fno-exceptions
CPP_COMMON_FLAGS += -ffunction-sections
CPP_COMMON_FLAGS += -fdata-sections
CPP_COMMON_FLAGS += -funsigned-char
CPP_COMMON_FLAGS += -MMD
CPP_COMMON_FLAGS += -fomit-frame-pointer
CPP_COMMON_FLAGS += -Os
CPP_COMMON_FLAGS += -g
CPP_COMMON_FLAGS += -DMBED_TRAP_ERRORS_ENABLED=1
CPP_COMMON_FLAGS += -DMBED_MINIMAL_PRINTF
CPP_COMMON_FLAGS += -mcpu=cortex-m7
CPP_COMMON_FLAGS += -mthumb
CPP_COMMON_FLAGS += -mfpu=fpv5-sp-d16
CPP_COMMON_FLAGS += -mfloat-abi=softfp
CPP_COMMON_FLAGS += -DMBED_ROM_START=0x8000000
CPP_COMMON_FLAGS += -DMBED_ROM_SIZE=0x100000
CPP_COMMON_FLAGS += -DMBED_ROM1_START=0x200000
CPP_COMMON_FLAGS += -DMBED_ROM1_SIZE=0x100000
CPP_COMMON_FLAGS += -DMBED_RAM_START=0x20010000
CPP_COMMON_FLAGS += -DMBED_RAM_SIZE=0x40000
CPP_COMMON_FLAGS += -DMBED_RAM1_START=0x20000000
CPP_COMMON_FLAGS += -DMBED_RAM1_SIZE=0x10000 

#CPP_COMMON_FLAGS += -fno-rtti \
	-include mbed_config.h \
	-std=gnu++98

###############################################################################
#
# Flags and symbols required by the compiler.
#
#CC_SYMBOLS += -D__MBED__=1 
#CC_SYMBOLS += -DDEVICE_I2CSLAVE=1
#CC_SYMBOLS += -D__FPU_PRESENT=1
#CC_SYMBOLS += -DTARGET_Freescale
#CC_SYMBOLS += -DDEVICE_PORTINOUT=1
#CC_SYMBOLS += -DTARGET_RTOS_M4_M7
#CC_SYMBOLS += -DDEVICE_LOWPOWERTIMER=1
#CC_SYMBOLS += -DDEVICE_RTC=1
#CC_SYMBOLS += -DTOOLCHAIN_object
#CC_SYMBOLS += -D__CMSIS_RTOS
#CC_SYMBOLS += -DFSL_RTOS_MBED
#CC_SYMBOLS += -DDEVICE_STORAGE=1
#CC_SYMBOLS += -DMBEDTLS_ENTROPY_HARDWARE_ALT
#CC_SYMBOLS += -DTARGET_KPSDK_MCUS
#CC_SYMBOLS += -DTOOLCHAIN_GCC
#CC_SYMBOLS += -DTARGET_CORTEX_M
#CC_SYMBOLS += -DTARGET_KSDK2_MCUS
#CC_SYMBOLS += -DTARGET_LIKE_CORTEX_M4
#CC_SYMBOLS += -DDEVICE_ANALOGOUT=1
#CC_SYMBOLS += -DTARGET_M4
#CC_SYMBOLS += -DTARGET_UVISOR_UNSUPPORTED
#CC_SYMBOLS += -DTARGET_K64F
#CC_SYMBOLS += -DDEVICE_SERIAL=1
#CC_SYMBOLS += -DMBED_BUILD_TIMESTAMP=1482431125.39
#CC_SYMBOLS += -DDEVICE_INTERRUPTIN=1
#CC_SYMBOLS += -DDEVICE_I2C=1
#CC_SYMBOLS += -DDEVICE_PORTOUT=1
#CC_SYMBOLS += -D__CORTEX_M4
#CC_SYMBOLS += -DDEVICE_STDIO_MESSAGES=1
#CC_SYMBOLS += -DCPU_MK64FN1M0VMD12
#CC_SYMBOLS += -DFEATURE_IPV4=1
#CC_SYMBOLS += -DTARGET_LIKE_MBED
#CC_SYMBOLS += -DTARGET_FF_ARDUINO
#CC_SYMBOLS += -DTARGET_KPSDK_CODE
#CC_SYMBOLS += -DTARGET_RELEASE
#CC_SYMBOLS += -DDEVICE_SERIAL_FC=1
#CC_SYMBOLS += -DFEATURE_STORAGE=1
#CC_SYMBOLS += -D__MBED_CMSIS_RTOS_CM
#CC_SYMBOLS += -DDEVICE_SLEEP=1
#CC_SYMBOLS += -DTOOLCHAIN_GCC_ARM
#CC_SYMBOLS += -DTARGET_FRDM
#CC_SYMBOLS += -DDEVICE_SPI=1
#CC_SYMBOLS += -DDEVICE_ERROR_RED=1
#CC_SYMBOLS += -DDEVICE_SPISLAVE=1
#CC_SYMBOLS += -DDEVICE_ANALOGIN=1
#CC_SYMBOLS += -DDEVICE_PWMOUT=1
#CC_SYMBOLS += -DDEVICE_PORTIN=1
#CC_SYMBOLS += -DTARGET_MCU_K64F
#CC_SYMBOLS += -DARM_MATH_CM4 

###############################################################################
#
# Flags and symbols required by the linker.
#
#LD_FLAGS += $(CPU) \
	-Wl,--gc-sections \
	-Wl,--wrap,main \
	-u _printf_float \
	-u _scanf_float

LD_FLAGS :=-Wl,--gc-sections -Wl,--wrap,main -Wl,--wrap,_malloc_r -Wl,--wrap,_free_r -Wl,--wrap,_realloc_r -Wl,--wrap,_memalign_r -Wl,--wrap,_calloc_r -Wl,--wrap,exit -Wl,--wrap,atexit -Wl,-n -Wl,--wrap,printf -Wl,--wrap,sprintf -Wl,--wrap,snprintf -Wl,--wrap,vprintf -Wl,--wrap,vsprintf -Wl,--wrap,vsnprintf -Wl,--wrap,fprintf -Wl,--wrap,vfprintf -mcpu=cortex-m7 -mthumb -mfpu=fpv5-sp-d16 -mfloat-abi=softfp -DMBED_ROM_START=0x8000000 -DMBED_ROM_SIZE=0x100000 -DMBED_ROM1_START=0x200000 -DMBED_ROM1_SIZE=0x100000 -DMBED_RAM_START=0x20010000 -DMBED_RAM_SIZE=0x40000 -DMBED_RAM1_START=0x20000000 -DMBED_RAM1_SIZE=0x10000 -DMBED_BOOT_STACK_SIZE=4096 -DXIP_ENABLE=0 
LD_SYS_LIBS :=-Wl,--start-group -lstdc++ -lsupc++ -lm -lc -lgcc -lnosys -lmbed -Wl,--end-group 

#LD_SYS_LIBS += -lstdc++ \
	-lsupc++ \
	-lm \
	-lc \
	-lgcc \
	-lnosys 

